FROM python:3

ARG DJANGO_SETTINGS_MODULE

RUN mkdir /northpole
WORKDIR /northpole
COPY requirements.txt /northpole/

RUN pip3 install --upgrade pip

RUN pip3 install -r requirements.txt

#RUN apk del -r python3-dev postgresql

# Enable bash on heroku exec
RUN apt-get update && apt-get install -y bash curl openssh-server iproute2
ADD deploy/.profile.d /app/.profile.d
RUN rm /bin/sh && ln -s /bin/bash /bin/sh

#Add logfile
RUN mkdir -m 755 /var/log/northpoler
RUN touch -m 777 /var/log/northpoler/logger.log

ENV PYTHONUNBUFFERED 1
COPY . /northpole/
